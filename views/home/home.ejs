<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/homestyle.css" />
  </head>
  <body>
    <div class="container">
      <form
        id="searchForm"
        class="form"
        action="javascript:void(0)"
        method="post"
      >
        <input id="searchInput" type="text" name="search" value="" />
        <input id="searchButton" type="submit" value="Search" />
      </form>
    </div>
    <div class="container">
      <form class="form" action="/home/logout" method="post">
        <input type="submit" value="Logout" />
      </form>
    </div>
    <div class="usernameContainer">
      <p>Username: <%= userData.username %></p>
    </div>
    <div class="mainContainer">
      <div class="leftContainer">
        <% linkedConcerts.forEach(function(linkedConcert) { %> <% if
        (linkedConcert.userId === userData.id) { %>
        <!-- Update the condition to use userData.id -->
        <p><%= linkedConcert.Concert.name %></p>
        <% } %> <% }); %>
      </div>

      <div class="rightContainer">
        <% concerts.forEach(function(concert) { %>
        <div>
          <h2><%= concert.concert.name %></h2>
          <% concert.associatedUsernames.forEach(function(username) { %>
          <p>Username: <%= username %></p>
          <% }); %>
        </div>
        <% }); %>
      </div>
      <div id="searchResultsContainer"></div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        // Attach an event listener to the search button
        $("#searchForm").submit(function (event) {
          event.preventDefault(); // Prevent form submission

          var searchKeyword = $("#searchInput").val();
          searchEvents(searchKeyword);
        });

        function searchEvents(keyword) {
          $.ajax({
            type: "GET",
            url: "https://app.ticketmaster.com/discovery/v2/events.json",
            async: true,
            dataType: "json",
            data: {
              keyword: keyword,
              size: 10,
              apikey: "83FaiAZhCP41A21Ku8BCVMDVxlV9UOO8",
              // Add other query parameters as needed
            },
            success: function (json) {
              console.log(json);
              // Parse the response and handle the search results
              displaySearchResults(json);
            },
            error: function (xhr, status, err) {
              console.error(err);
              // Handle the error case
            },
          });
        }
        function displaySearchResults(json) {
          var searchResultsContainer = $("#searchResultsContainer");
          searchResultsContainer.empty(); // Clear previous search results

          // Loop through the search results and create the HTML for each result
          json.results.forEach(function (result) {
            var resultElement = $("<div>").addClass("searchResult");
            resultElement.append($("<h2>").text(result.name));
            // Add other relevant data from the search results

            searchResultsContainer.append(resultElement);
          });
        }
      });
    </script>
  </body>
</html>
